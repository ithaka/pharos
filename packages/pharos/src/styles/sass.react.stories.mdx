import { Story, Canvas, Meta } from '@storybook/addon-docs';
import sass_values from '../../../../.storybook/sass';

<Meta
  title="Styles/Sass"
  parameters={{
    options: { selectedPanel: 'addon-controls' },
  }}
/>

export const toTokenFormat = (text) => {
  return (
    <code style={{ fontSize: 'var(--pharos-font-size-small)' }}>
      {text
        .replace(/([a-z])([A-Z]|[0-9])/g, '$1-$2')
        .replace(/([0-9])([a-z]|[A-Z])/g, '$1-$2')
        .replace(/([A-Z])([A-Z])/g, '$1-$2')
        .toLowerCase()}
    </code>
  );
};

export const renderCssAttributes = (attributes) => {
  let cssHTML = attributes.map((element, index) => {
    if (element.indexOf(':') != -1) {
      var property = element.substr(0, element.indexOf(':') + 1);
      var remaining = element.substr(element.indexOf(':') + 1, element.length - 1);
      return (
        <div key={index}>
          <code
            style={{
              backgroundColor: 'var(--pharos-color-marble-gray-97)',
              fontSize: 'var(--pharos-font-size-micro)',
            }}
          >
            <span
              style={{
                color: 'var(--pharos-color-jstor-red)',
                backgroundColor: 'var(--pharos-color-marble-gray-97)',
                paddingRight: '0px',
                marginRight: '0px',
              }}
            >
              {property}
            </span>
            {remaining}
          </code>
          <br />
        </div>
      );
    } else {
      return (
        <>
          <code
            style={{
              backgroundColor: 'var(--pharos-color-marble-gray-97)',
              fontSize: 'var(--pharos-font-size-micro)',
            }}
          >
            {element}
          </code>{' '}
          <br />
        </>
      );
    }
  });
  return cssHTML;
};

export const MixinTable = (title) => {
  return (
    <div className="token-table-container">
      <h2>{title}</h2>
      <table className="token-table">
        <thead>
          <tr>
            <th style={{ width: '26%' }}>Token</th>
            <th style={{ width: '14%' }}>Usage description</th>
            <th style={{ width: '60%' }}>CSS attributes</th>
          </tr>
        </thead>
        <tbody>
          {Object.keys(sass_values.mixins).map((key, index) => {
            if (sass_values.mixins[key].category == title) {
              return (
                <tr key={index}>
                  <td>{toTokenFormat(sass_values.mixins[key].name)}</td>
                  <td>{sass_values.mixins[key].usage}</td>
                  <td>
                    <div
                      style={{
                        backgroundColor: 'var(--pharos-color-marble-gray-97)',
                        borderStyle: 'solid',
                        borderColor: 'var(--pharos-color-marble-gray-80)',
                        paddingBottom: 'var(--pharos-spacing-one-eighth-x)',
                        borderWidth: '1px',
                      }}
                    >
                      {renderCssAttributes(sass_values.mixins[key].parameters)}
                    </div>
                  </td>
                </tr>
              );
            } else return;
          })}
        </tbody>
      </table>
      <br />
      <br />
    </div>
  );
};

export const PharosMixins = () => (
  <>
    {MixinTable('Buttons')} {MixinTable('Form elements')} {MixinTable('Interaction')}
    {MixinTable('Layout')} {MixinTable('Links')} {MixinTable('Typography')}
  </>
);

<Canvas withToolbar>
  <Story name="Mixins">{PharosMixins()}</Story>
</Canvas>
