import { Story, Canvas, Meta } from '@storybook/addon-docs';
import { html } from 'lit';

import sass_values from '../../../../.storybook/sass';

<Meta
  title="Styles/Sass"
  parameters={{
    options: { selectedPanel: 'addon-controls' },
  }}
/>

export const toTokenFormat = (text) => {
  return html`<code
    >$${text
      .replace(/([a-z])([A-Z]|[0-9])/g, '$1-$2')
      .replace(/([0-9])([a-z]|[A-Z])/g, '$1-$2')
      .replace(/([A-Z])([A-Z])/g, '$1-$2')
      .toLowerCase()}
  </code>`;
};

export const renderCssAttributes = (attributes) => {
  let cssHTML = attributes.map((element) => {
    if (element.indexOf(':') != -1) {
      var property = element.substr(0, element.indexOf(':') + 1);
      var remaining = element.substr(element.indexOf(':') + 1, element.length - 1);
      return html` <div style="background-color: var(--pharos-color-marble-gray-94);">
        <code
          style="color:var(--pharos-color-jstor-red); background-color:var(--pharos-color-marble-gray-94);"
          >${property}</code
        ><code style="background-color:var(--pharos-color-marble-gray-94)">${remaining}</code>
        <br />
      </div>`;
    } else {
      return html` <div style="background-color:var(--pharos-color-marble-gray-94);">
        <code style="background-color:var(--pharos-color-marble-gray-94)">${element}</code>
        <br />
      </div>`;
    }
  });
  return cssHTML;
};

export const TokenTable = (title, content) => {
  return html`
    <div class="token-table-container">
      <h2>${title}</h2>
      <table class="token-table">
        ${content}
      </table>
      <br />
      <br />
    </div>
  `;
};

export const PharosMixins = () => html`
  ${TokenTable(
    'Sass Mixins',
    html`
      <thead>
        <tr>
          <th style="width:10%">Token</th>
          <th style="width:50%">CSS attributes</th>
          <th style="width:40%">Usage description</th>
        </tr>
      </thead>
      <tbody>
        ${Object.keys(sass_values.mixins).map((key) => {
          return html`
            <tr>
              <td>${toTokenFormat(sass_values.mixins[key].name)}</td>
              <td>${renderCssAttributes(sass_values.mixins[key].parameters)}</td>
              <td>${sass_values.mixins[key].usage}</td>
            </tr>
          `;
        })}
      </tbody>
    `
  )}
`;

<Canvas withToolbar>
  <Story name="Mixins">{PharosMixins()}</Story>
</Canvas>
