import { Story, Canvas, Meta } from '@storybook/addon-docs';
import { html } from 'lit';

import sass_values from '../../../../.storybook/sass';

<Meta
  title="Styles/Sass"
  parameters={{
    options: { selectedPanel: 'addon-controls' },
  }}
/>

export const toTokenFormat = (text) => {
  return html`<code style="font-size:var(--pharos-font-size-small);"
    >$${text
      .replace(/([a-z])([A-Z]|[0-9])/g, '$1-$2')
      .replace(/([0-9])([a-z]|[A-Z])/g, '$1-$2')
      .replace(/([A-Z])([A-Z])/g, '$1-$2')
      .toLowerCase()}
  </code>`;
};

export const renderCssAttributes = (attributes) => {
  let cssHTML = attributes.map((element) => {
    if (element.indexOf(':') != -1) {
      var property = element.substr(0, element.indexOf(':') + 1);
      var remaining = element.substr(element.indexOf(':') + 1, element.length - 1);
      return html` <code
          style="background-color:var(--pharos-color-marble-gray-97); font-size:var(--pharos-font-size-micro)"
        >
          <span
            style="color:var(--pharos-color-jstor-red); background-color:var(--pharos-color-marble-gray-97)"
            >${property}</span
          >${remaining}</code
        >
        <br />`;
    } else {
      return html` <code style="background-color:var(--pharos-color-marble-gray-97); font-size:var(--pharos-font-size-micro)>${element}</code>
        <br />`;
    }
  });
  return cssHTML;
};

export const TokenTable = (title, content) => {
  return html`
    <div class="token-table-container">
      <h2>${title}</h2>
      <table class="token-table">
        ${content}
      </table>
      <br />
      <br />
    </div>
  `;
};

export const MixinTable = (title) => {
  return html`
    <div class="token-table-container">
      <h2>${title}</h2>
      <table class="token-table">
        <thead>
          <tr>
            <th style="width:26%">Token</th>
            <th style="width:14%">Usage description</th>
            <th style="width:60%">CSS attributes</th>
          </tr>
        </thead>
        <tbody>
          ${Object.keys(sass_values.mixins).map((key) => {
            if (sass_values.mixins[key].category == title) {
              return html`
                <tr>
                  <td>${toTokenFormat(sass_values.mixins[key].name)}</td>
                  <td>${sass_values.mixins[key].usage}</td>
                  <td>
                    <div
                      style="background-color:var(--pharos-color-marble-gray-97); border-style: solid; border-color: var(--pharos-color-marble-gray-80); padding-bottom:var(--pharos-spacing-one-eighth-x); border-width: 1px"
                    >
                      ${renderCssAttributes(sass_values.mixins[key].parameters)}
                    </div>
                  </td>
                </tr>
              `;
            } else return;
          })}
        </tbody>
      </table>
      <br />
      <br />
    </div>
  `;
};

export const PharosMixins = () => html`
  ${MixinTable('Buttons')} ${MixinTable('Form elements')} ${MixinTable('Interaction')} ${MixinTable(
    'Layout'
  )} ${MixinTable('Links')} ${MixinTable('Typography')}
`;

<Canvas withToolbar>
  <Story name="Mixins">{PharosMixins()}</Story>
</Canvas>
